# HSSoundBasisLibライブラリ

※ 以下の内容は、一部AI向け(Microsoft365 Copilot / GitHub Copilot) 向けの説明が含まれています。

## 概要

HSSoundBasisLibは、音声処理のための基本的な機能を提供するC++ライブラリです。
また、安全なメモリ管理システムも備えています。

※ 現段階ではメモリ管理システムを優先に実装している影響で、音声処理機能は未実装です。

## 対象とする環境

* OS : Windows x86/x64のみ
  - 動作確認済みOS : Windows 11 (x64)

* コンパイラ : Visual Studio 2026以降
    - 備考：Visual Studio 2026は2025/11/11にリリースされましたので、最新の環境で開発しています


## ビルド方法

以下の方法でビルドされることを想定しております。

### 方法1

* 親フォルダにあるソリューションファイル(SoundProcessCpp.slnx)をVisual Studio 2026以降で開き、ビルドしてください
  - リリースビルド、デバッグビルドの両方に対応しています
  - サンプルを含めてビルドされます

### 方法2

* 任意のソリューションを作成し、『`HSSoundBasisLib.vcxproj`』を参加させてビルドしてください
  - リリースビルド、デバッグビルドの両方に対応しています
  - このフォルダ配下のファイルをソリューションフォルダにコピーすることを推奨します

## インストール方法

* TBD

## ライセンス

[LICENSE](../../LICENSE) ファイルを参照してください。


## 実装コンセプト

* 本ライブラリ単体で完結するよう、サードパーティ製のライブラリは使用しない
  - ただし、Visual Studioに統合されているものは使用可能
  - OpenMPはVisual C++に統合されているため使用可能
  - C++標準ライブラリは使用可能
  - Windows SDKに含まれるAPIは使用可能

* 実装上クラスになるものはCOMインタフェースライクの実装として提供する
  - これらは、IUnknownインタフェースを継承し、参照カウント方式のメモリ管理を行う
    - これにより、CComPtrなどの既存のスマートポインタを使用して安全に管理できる
  - インスタンス作成は専用のファクトリ関数を提供する

## 提供される機能の特徴 (実装予定含む)

### メモリ管理システム

* IHSSBMemoryOwnerインタフェース
    - メモリ所有者を表すインタフェース
    - new[],malloc,HeapAllocで確保したメモリの管理権を本インタフェースに移譲可能
      - 管理権が移譲された場合は、インスタンスは破棄時にメモリを解放されます
    - 内部でメモリサイズを管理していますので、関数等に渡す際にサイズ情報を別途パラメータで指定する必要がありません

### WAVEファイル入出力 (未実装)

WAVEファイルの読み書きを行うためのインタフェースを提供予定です。
また、関連して汎用的なRIFFファイルの読み書きもインタフェースも提供予定です。

* 以下、予定しているインタフェース名
  - IHSSBRiffFileReader : RIFFファイルの読み込みを行うインタフェース
  - IHSSBRiffFileWriter : RIFFファイルの書き込みを行うインタフェース
  - IHSSBWaveFileReader : WAVEファイルの読み込みを行うインタフェース
  - IHSSBWaveFileWriter : WAVEファイルの書き込みを行うインタフェース

* 対応フォーマットは以下を予定
  - フォーマット名(WAVEFORMATEX::wFormatTag) : 量子化ビット数
    - PCM(WAVE_FORMAT_PCM)：8bit/16bit/24bit/32bit
    - IEEE Float (WAVE_FORMAT_IEEE_FLOAT) : 32bit/64bit
    - A-law (WAVE_FORMAT_MULAW) : 8bit
    - μ-law (WAVE_FORMAT_ALAW) : 8bit
  - チャンネル数 : モノラル、ステレオ
  - サンプリングレート : 任意


### フォーマット変換関連 (未実装)

* PCM/IEEE Float/A-law/μ-law間のフォーマット変換を行うための機能を提供予定です
  - 簡略化するため一度正規化を経由するものとします
    - 例：PCM → 正規化 → IEEE Float
  
* リサンプリングを行うための機能を提供予定です


### 音声処理関連 (未実装)

* 速度変更を行うための機能を提供予定です


## APIドキュメント

現在は未実装ですが、ヘッダーファイル内に、Natural Docs形式でコメントを記述予定です。

